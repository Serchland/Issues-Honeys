<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:coreNameDef="clr-namespace:IssuesHoneys.Core.NameDefinition;assembly=IssuesHoneys.Core"
             xmlns:coreViews="clr-namespace:IssuesHoneys.Core.Views;assembly=IssuesHoneys.Core"
             xmlns:converters="clr-namespace:IssuesHoneys.Modules.Issues.Views.Converters"
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             x:Class="IssuesHoneys.Modules.Issues.Views.IssuesView"
             prism:ViewModelLocator.AutoWireViewModel="True">

    <UserControl.Resources>
        <converters:IconCommentsVisibilityConverter x:Key="IconCommentsVisibilityConverterKey"></converters:IconCommentsVisibilityConverter>
        <converters:IconMilestoneVisibilityConverter x:Key="IconMilestoneVisibilityConverterKey"></converters:IconMilestoneVisibilityConverter>
        <converters:StateColorConverter x:Key="StateColorConverterKey"></converters:StateColorConverter>
    </UserControl.Resources>

    <Grid x:Name="grid"
          Margin="15">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Column="0"
              Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition  Width="*"></ColumnDefinition>
                <ColumnDefinition  Width="*"></ColumnDefinition>
                <ColumnDefinition  Width="*"></ColumnDefinition>
                <ColumnDefinition  Width="Auto"></ColumnDefinition>
                <ColumnDefinition  Width="Auto"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition>
            </Grid.RowDefinitions>

            <DockPanel Grid.Column="0"
                       Grid.Row="0"
                       Grid.ColumnSpan="2">

                <Label VerticalAlignment="Center"
                       Content="Filter:">
                </Label>

                <ComboBox BorderBrush="LightGray"
                          VerticalAlignment="Center"></ComboBox>
            </DockPanel>

            <coreViews:ButtonLabels Grid.Column="2"
                                    Grid.Row="0"
                                    MinWidth="145"
                                    coreViews:ButtonLabels.TotalItems="{Binding TotalLabels}">

                
            </coreViews:ButtonLabels>

            <coreViews:ButtonMilestones Grid.Column="3"
                                        Grid.Row="0"
                                        MinWidth="145"
                                        coreViews:ButtonMilestones.TotalItems="{Binding TotalMilestones}">
            </coreViews:ButtonMilestones>

            <!--Click="Button_Click"-->
            <Button Grid.Column="4"
                    Grid.Row="0"
                    BorderBrush="LightGray"
                    Background="LightGreen"
                    Command="{Binding NavigateCommand}"
                    CommandParameter="{x:Static coreNameDef:CommandParameters.NewIssue}"
                    Margin="30,0,5,0"
                    MinWidth="100"
                    HorizontalAlignment="Right"
                    Content="{StaticResource ButtonNewIssueCaption}"
                    controls:ControlsHelper.FocusBorderBrush="Orange">
            </Button>
        </Grid>

        <Grid Grid.Column="0"
              Grid.Row="1">

            <Grid Grid.Row="0"
                  Margin="0">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Border Grid.Row="0"
                        BorderThickness="1"
                        BorderBrush="{StaticResource MainBorderBrush}"
                        Margin="5,5,5,0"
                        
                        Background="WhiteSmoke">
                    <Grid MinHeight="40">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="200" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <CheckBox Grid.Column="0"
                                  Margin="5,0,0,0"
                                  VerticalAlignment="Center" />

                        <StackPanel Grid.Column="1"
                        
                                    Orientation="Horizontal"
                                    VerticalAlignment="Center">

                            <Label VerticalContentAlignment="Center">
                                <iconPacks:Codicons Width="18"
                                                    Height="18"
                                                    Kind="Issues" />
                            </Label>

                            <Label Content="8 Open (2 Closed)"
                                   VerticalContentAlignment="Center" />
                        </StackPanel>

                        <Grid Grid.Column="3"
                              Grid.ColumnSpan="5"
                              HorizontalAlignment="Right">

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                            </Grid.ColumnDefinitions>


                            <mah:DropDownButton Grid.Column="0"
                                        Grid.Row="0"
                                        Margin="5,0,8,0"
                                        BorderBrush="Transparent"
                                        Background="Transparent"
                                        VerticalAlignment="Center" 
                                        HorizontalAlignment="Right"
                                        ItemsSource="{Binding Users}"
                                        Content="{StaticResource DropDownAuthors}">
                                
                                <mah:DropDownButton.ItemTemplate>
                                    <DataTemplate>
                                        <Grid SnapsToDevicePixels="True">
                                            <Rectangle Name="Border" Stroke="Transparent" StrokeThickness="1"/>
                                            <Grid>
                                                
                                                <StackPanel Orientation="Horizontal" >
                                                    <Label>
                                                        <iconPacks:PackIconBoxIcons Kind="RegularUser" />
                                                    </Label>
                                                    <Label Content="{Binding Name}"></Label>
                                                    <Label Content="{Binding SurName}"></Label>
                                                </StackPanel>
                                                
                                                <ContentPresenter Grid.Column="1" Margin="6"
                                                        Content=""
                                                        RecognizesAccessKey="True"
                                                        SnapsToDevicePixels="True"/>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </mah:DropDownButton.ItemTemplate>

                                <mah:DropDownButton.ItemContainerStyle>
                                    <Style BasedOn="{StaticResource {x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                                        <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:DropDownButton}}, Path=DataContext.FilterIssuesCommand}" />
                                        <Setter Property="CommandParameter" Value="{Binding Name}" />

                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="Gold" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </mah:DropDownButton.ItemContainerStyle>
                            </mah:DropDownButton>

                            <mah:DropDownButton Grid.Column="1"
                                        Grid.Row="0"
                                        Margin="5,0,8,0"
                                        BorderBrush="Transparent"
                                        Background="Transparent"
                                        VerticalAlignment="Center" 
                                        HorizontalAlignment="Right"
                                        ItemsSource="{Binding Labels}"
                                        Content="{StaticResource DropDownLabel}">

                                <mah:DropDownButton.ItemTemplate>
                                    <DataTemplate>
                                        <Grid SnapsToDevicePixels="True">
                                            
                                            <Grid>

                                                <StackPanel Orientation="Horizontal" >
                                                    <Border 
                                                        x:Name="circularBorder"
                                                        BorderThickness="1"
                                                        BorderBrush="LightGray"
                                                        Background="{Binding Path=Color}"
                                                        CornerRadius="{Binding Path=ActualHeight, ElementName=circularBorder}"
                                                        Width="{Binding Path=ActualHeight, ElementName=circularBorder}">

                                                    <Label 
                                                        BorderThickness="1"
                                                        Padding="0"
                                                        
                                                        />
                                                    </Border>
                                                    <Label Content="{Binding Name}"></Label>
                                                </StackPanel>
                                                

                                                <ContentPresenter Grid.Column="1" Margin="6"
                                                        Content=""
                                                        RecognizesAccessKey="True"
                                                        SnapsToDevicePixels="True"/>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </mah:DropDownButton.ItemTemplate>

                                <mah:DropDownButton.ItemContainerStyle>
                                    <Style BasedOn="{StaticResource {x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                                        <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:DropDownButton}}, Path=DataContext.FilterIssuesCommand}" />
                                        <Setter Property="CommandParameter" Value="{Binding Title}" />

                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="Gold" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </mah:DropDownButton.ItemContainerStyle>
                            </mah:DropDownButton>

                            <mah:DropDownButton Grid.Column="2"
                                        Grid.Row="0"
                                        Margin="5,0,8,0"
                                        BorderBrush="Transparent"
                                        Background="Transparent"
                                        VerticalAlignment="Center" 
                                        HorizontalAlignment="Right"
                                        ItemsSource="{Binding Users}"
                                        Content="{StaticResource DropDownProjects}">

                                <mah:DropDownButton.ItemTemplate>
                                    <DataTemplate>
                                        <Grid SnapsToDevicePixels="True">
                                            <Rectangle Name="Border" Stroke="Transparent" StrokeThickness="1"/>
                                            <Grid>

                                                <StackPanel Orientation="Horizontal" >
                                                    <Label>
                                                        <iconPacks:PackIconBoxIcons Kind="RegularUser" />
                                                    </Label>
                                                    <Label Content="{Binding Name}"></Label>
                                                    <Label Content="{Binding SurName}"></Label>
                                                </StackPanel>

                                                <ContentPresenter Grid.Column="1" Margin="6"
                                                        Content=""
                                                        RecognizesAccessKey="True"
                                                        SnapsToDevicePixels="True"/>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </mah:DropDownButton.ItemTemplate>

                                <mah:DropDownButton.ItemContainerStyle>
                                    <Style BasedOn="{StaticResource {x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                                        <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:DropDownButton}}, Path=DataContext.SelectedSortItemCommand}" />
                                        <Setter Property="CommandParameter" Value="{Binding Name}" />

                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="Gold" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </mah:DropDownButton.ItemContainerStyle>
                            </mah:DropDownButton>

                            <mah:DropDownButton Grid.Column="3"
                                        Grid.Row="0"
                                        Margin="5,0,8,0"
                                        BorderBrush="Transparent"
                                        Background="Transparent"
                                        VerticalAlignment="Center" 
                                        HorizontalAlignment="Right"
                                        ItemsSource="{Binding Users}"
                                        Content="{StaticResource DropDownMilestones}">

                                <mah:DropDownButton.ItemTemplate>
                                    <DataTemplate>
                                        <Grid SnapsToDevicePixels="True">
                                            <Rectangle Name="Border" Stroke="Transparent" StrokeThickness="1"/>
                                            <Grid>

                                                <StackPanel Orientation="Horizontal" >
                                                    <Label>
                                                        <iconPacks:PackIconBoxIcons Kind="RegularUser" />
                                                    </Label>
                                                    <Label Content="{Binding Name}"></Label>
                                                    <Label Content="{Binding SurName}"></Label>
                                                </StackPanel>

                                                <ContentPresenter Grid.Column="1" Margin="6"
                                                        Content=""
                                                        RecognizesAccessKey="True"
                                                        SnapsToDevicePixels="True"/>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </mah:DropDownButton.ItemTemplate>

                                <mah:DropDownButton.ItemContainerStyle>
                                    <Style BasedOn="{StaticResource {x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                                        <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:DropDownButton}}, Path=DataContext.SelectedSortItemCommand}" />
                                        <Setter Property="CommandParameter" Value="{Binding Name}" />

                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="Gold" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </mah:DropDownButton.ItemContainerStyle>
                            </mah:DropDownButton>

                            <mah:DropDownButton Grid.Column="4"
                                        Grid.Row="0"
                                        Margin="5,0,8,0"
                                        BorderBrush="Transparent"
                                        Background="Transparent"
                                        VerticalAlignment="Center" 
                                        HorizontalAlignment="Right"
                                        ItemsSource="{Binding Users}"
                                        Content="{StaticResource DropDownAssignee}">

                                <mah:DropDownButton.ItemTemplate>
                                    <DataTemplate>
                                        <Grid SnapsToDevicePixels="True">
                                            <Rectangle Name="Border" Stroke="Transparent" StrokeThickness="1"/>
                                            <Grid>

                                                <StackPanel Orientation="Horizontal" >
                                                    <Label>
                                                        <iconPacks:PackIconBoxIcons Kind="RegularUser" />
                                                    </Label>
                                                    <Label Content="{Binding Name}"></Label>
                                                    <Label Content="{Binding SurName}"></Label>
                                                </StackPanel>

                                                <ContentPresenter Grid.Column="1" Margin="6"
                                                        Content=""
                                                        RecognizesAccessKey="True"
                                                        SnapsToDevicePixels="True"/>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </mah:DropDownButton.ItemTemplate>

                                <mah:DropDownButton.ItemContainerStyle>
                                    <Style BasedOn="{StaticResource {x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                                        <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:DropDownButton}}, Path=DataContext.SelectedSortItemCommand}" />
                                        <Setter Property="CommandParameter" Value="{Binding Name}" />

                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="Gold" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </mah:DropDownButton.ItemContainerStyle>
                            </mah:DropDownButton>

                            <mah:DropDownButton Grid.Column="5"
                                        Grid.Row="0"
                                        Margin="5,0,8,0"
                                        BorderBrush="Transparent"
                                        Background="Transparent"
                                        VerticalAlignment="Center" 
                                        HorizontalAlignment="Right"
                                        ItemsSource="{Binding Users}"
                                        Content="{StaticResource DropDownSort}">

                                <mah:DropDownButton.ItemTemplate>
                                    <DataTemplate>
                                        <Grid SnapsToDevicePixels="True">
                                            <Rectangle Name="Border" Stroke="Transparent" StrokeThickness="1"/>
                                            <Grid>

                                                <StackPanel Orientation="Horizontal" >
                                                    <Label>
                                                        <iconPacks:PackIconBoxIcons Kind="RegularUser" />
                                                    </Label>
                                                    <Label Content="{Binding Name}"></Label>
                                                    <Label Content="{Binding SurName}"></Label>
                                                </StackPanel>

                                                <ContentPresenter Grid.Column="1" Margin="6"
                                                        Content=""
                                                        RecognizesAccessKey="True"
                                                        SnapsToDevicePixels="True"/>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </mah:DropDownButton.ItemTemplate>

                                <mah:DropDownButton.ItemContainerStyle>
                                    <Style BasedOn="{StaticResource {x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                                        <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:DropDownButton}}, Path=DataContext.SelectedSortItemCommand}" />
                                        <Setter Property="CommandParameter" Value="{Binding Name}" />

                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="Gold" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </mah:DropDownButton.ItemContainerStyle>
                            </mah:DropDownButton>

                        </Grid>
                    </Grid>
                </Border>

                <ListView x:Name="PART_ListIssues"
                          Grid.Row="1"
                          Grid.ColumnSpan="5"
                          BorderThickness="1 0 1 1"
                          BorderBrush="{StaticResource MainBorderBrush}"
                          Margin="5,0,5,5"
                          SelectedItem="{Binding SelectedItem}"
                          ItemsSource="{Binding Issues}">

                    <ListView.ItemContainerStyle>
                        <Style TargetType="{x:Type ListViewItem}">
                            <Setter Property="BorderThickness"
                                    Value="0,0,0,0.5" />
                            <Setter Property="BorderBrush"
                                    Value="LightGray"/>

                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ListViewItem}">
                                        <Border x:Name="Bd"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                Background="{TemplateBinding Background}"
                                                Padding="{TemplateBinding Padding}"
                                                SnapsToDevicePixels="true">
                                            <ContentPresenter HorizontalAlignment="Stretch"
                                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <MultiTrigger>
                                                <MultiTrigger.Conditions>
                                                    <Condition Property="IsMouseOver"
                                                               Value="True" />
                                                </MultiTrigger.Conditions>
                                                <Setter Property="Background"
                                                        TargetName="Bd"
                                                        Value="Transparent" />
                                                <Setter Property="BorderBrush"
                                                        TargetName="Bd"
                                                        Value="LightGray" />
                                            </MultiTrigger>

                                            <MultiTrigger>
                                                <MultiTrigger.Conditions>
                                                    <Condition Property="Selector.IsSelectionActive"
                                                               Value="False" />
                                                    <Condition Property="IsSelected"
                                                               Value="True" />
                                                </MultiTrigger.Conditions>
                                                <Setter Property="Background"
                                                        TargetName="Bd"
                                                        Value="#3DDADADA" />
                                                <Setter Property="BorderBrush"
                                                        TargetName="Bd"
                                                        Value="#FFDADADA" />
                                            </MultiTrigger>
                                            <MultiTrigger>
                                                <MultiTrigger.Conditions>
                                                    <Condition Property="Selector.IsSelectionActive"
                                                               Value="True" />
                                                    <Condition Property="IsSelected"
                                                               Value="True" />
                                                </MultiTrigger.Conditions>
                                                <Setter Property="Background"
                                                        TargetName="Bd"
                                                        Value="#3D26A0DA" />
                                                <Setter Property="BorderBrush"
                                                        TargetName="Bd"
                                                        Value="#3D26A0DA" />
                                            </MultiTrigger>
                                            <Trigger Property="IsEnabled"
                                                     Value="False">
                                                <Setter Property="TextElement.Foreground"
                                                        TargetName="Bd"
                                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>

                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Border BorderThickness="0.5">
                                <Grid x:Name="PART_GridItemTemplate">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"
                                                       MinHeight="35"></RowDefinition>
                                        <RowDefinition Height="Auto"></RowDefinition>
                                    </Grid.RowDefinitions>

                                    <CheckBox Grid.Column="0"
                                              Grid.Row="0"
                                              VerticalAlignment="Center"
                                              IsChecked="{Binding RelativeSource={RelativeSource AncestorType=ListViewItem}, Path=IsSelected}">
                                    </CheckBox>

                                    <StackPanel Grid.Column="1"
                                                Grid.Row="0"
                                                Grid.ColumnSpan="2"
                                                Orientation="Horizontal">

                                        <Label VerticalContentAlignment="Center"
                                               Foreground="{Binding Path=State, Converter={StaticResource StateColorConverterKey}}">
                                            <iconPacks:Codicons Width="18"
                                                                Height="18"
                                                                Kind="Issues" />
                                        </Label>

                                        <TextBlock Text="{Binding Title}"
                                                   FontWeight="SemiBold"
                                                   FontSize="14"
                                                   HorizontalAlignment="Center"
                                                   TextAlignment="Center"
                                                   TextWrapping="WrapWithOverflow"
                                                   Padding="0,8,10,0">

                                            <TextBlock.InputBindings>
                                                <MouseBinding Command="{Binding ElementName=PART_ListIssues, Path=DataContext.NavigateCommand}" 
                                                              CommandParameter="{x:Static coreNameDef:CommandParameters.Comments}"
                                                              MouseAction="LeftClick" >
                                                </MouseBinding>
                                            </TextBlock.InputBindings>

                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Style.Triggers>
                                                        <Trigger Property ="IsMouseOver" Value="True">
                                                            <Setter Property= "Foreground" Value="Blue"/>
                                                            <Setter Property="TextDecorations" Value="Underline"></Setter>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>

                                            <TextBlock.ToolTip>
                                                <Grid Margin="10" Background="White">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"></RowDefinition>
                                                        <RowDefinition Height="Auto"></RowDefinition>
                                                        <RowDefinition Height="Auto"></RowDefinition>
                                                    </Grid.RowDefinitions>
                                                    <TextBlock Grid.Row="0" 
                                                               Text="{Binding CrtnDate, StringFormat=on {0:D}}" 
                                                               FontSize="10"
                                                               HorizontalAlignment="Left"
                                                               Margin="0 0 0 10"></TextBlock>

                                                    <StackPanel Grid.Row="1"
                                                                Orientation="Horizontal">

                                                        <TextBlock Text="{Binding Id, StringFormat=#{0}}"
                                                                   FontSize="14"></TextBlock>
                                                        <TextBlock Text=" "></TextBlock>
                                                        <TextBlock Text="{Binding Title}" 
                                                                   FontWeight="SemiBold"
                                                                   FontSize="14"></TextBlock>

                                                    </StackPanel>
                                                    <Viewbox Grid.Row="2" 
                                                             Margin="0 10 0 0"
                                                             HorizontalAlignment="Left">
                                                        <StackPanel Orientation="Vertical"
                                                                    MinWidth="500">
                                                            <TextBlock HorizontalAlignment="Left"
                                                                       FontSize="14"
                                                                       TextWrapping="Wrap"
                                                                       Foreground="Black"
                                                                       Text="{Binding Body}" />
                                                        </StackPanel>
                                                    </Viewbox>
                                                </Grid>
                                            </TextBlock.ToolTip>
                                        </TextBlock>

                                        <ListBox ItemsSource="{Binding Labels}"
                                                 Background="{Binding RelativeSource={RelativeSource AncestorType=ListViewItem}, Path=Background}"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">

                                            <ListBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel IsItemsHost="True"></WrapPanel>
                                                </ItemsPanelTemplate>
                                            </ListBox.ItemsPanel>

                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Border BorderThickness="0.5"
                                                            BorderBrush="LightGray"
                                                            VerticalAlignment="Center"
                                                            Margin="0,8,0,0"
                                                            Height="18"
                                                            MinWidth="50"
                                                            CornerRadius="10"
                                                            Background="{Binding Color}"
                                                            x:Name="PART_ItemBorder">

                                                        <TextBlock Text="{Binding Name}"
                                                                   HorizontalAlignment="Center"
                                                                   TextAlignment="Center"
                                                                   TextWrapping="WrapWithOverflow"
                                                                   Foreground="White"
                                                                   FontSize="10"
                                                                   Padding="5,0,5,0"
                                                                   Height="Auto"
                                                                   Name="PART_txtBlockName">

                                                            <TextBlock.ToolTip>
                                                                <Grid Margin="10" Background="White">
                                                                    <TextBlock Text="{Binding Description}"></TextBlock>
                                                                </Grid>
                                                            </TextBlock.ToolTip>
                                                        </TextBlock>
                                                    </Border>

                                                <!--    <DataTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}, Path=IsMouseOver}"
                                                                     Value="True">
                                                            <Setter Property=""
                                                                    Value="100" />
                                                        </DataTrigger>

                                                    </DataTemplate.Triggers>-->
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>

                                            <ListBox.ItemContainerStyle>
                                                <Style TargetType="ListBoxItem">
                                                    <Setter Property="Margin"
                                                            Value="0"></Setter>
                                                    <Setter Property="Padding"
                                                            Value="0"></Setter>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                                                <Border x:Name="Bd"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        Background="{TemplateBinding Background}"
                                                                        Padding="{TemplateBinding Padding}"
                                                                        SnapsToDevicePixels="true">
                                                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <MultiTrigger>
                                                                        <MultiTrigger.Conditions>
                                                                            <Condition Property="IsMouseOver"
                                                                                       Value="True" />
                                                                        </MultiTrigger.Conditions>
                                                                        <Setter Property="Background"
                                                                                TargetName="Bd"
                                                                                Value="Transparent" />
                                                                        <Setter Property="BorderBrush"
                                                                                TargetName="Bd"
                                                                                Value="Transparent" />
                                                                    </MultiTrigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </ListBox.ItemContainerStyle>
                                        </ListBox>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1"
                                                Grid.Row="1"
                                                Grid.RowSpan="2"
                                                Orientation="Horizontal"
                                                Margin="10 0 0 0"
                                                VerticalAlignment="Top">

                                        <TextBlock Text="{Binding Number, StringFormat=#{0}}" />
                                        <TextBlock Text=" "></TextBlock>
                                        <TextBlock Text="{Binding CrtnDate, StringFormat=opened on {0:D}}" />
                                        <TextBlock Text=" "></TextBlock>
                                        <TextBlock Text="{Binding Author, StringFormat=by {0}}" />
                                        <TextBlock Text="  "></TextBlock>
                                        <Label Foreground="Gray"
                                               Padding="0 0 0 10"
                                               Visibility="{Binding Milestones, Converter={StaticResource IconMilestoneVisibilityConverterKey}}">
                                            <iconPacks:PackIconUnicons Width="16"
                                                                       Height="16"
                                                                       Kind="SignRight">
                                            </iconPacks:PackIconUnicons>
                                        </Label>

                                        <ListBox ItemsSource="{Binding Milestones}"
                                                 Background="{Binding RelativeSource={RelativeSource AncestorType=ListViewItem}, Path=Background}"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">

                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="SelectionChanged">
                                                    <prism:InvokeCommandAction Command="{Binding DataContext.TestCommand, ElementName=PART_ListIssues}"
                                                                               CommandParameter="{Binding SelectedItem}"/>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>

                                            <ListBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel IsItemsHost="True"></WrapPanel>
                                                </ItemsPanelTemplate>
                                            </ListBox.ItemsPanel>

                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Title}" Background="Transparent">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Style.Triggers>
                                                                    <Trigger Property ="IsMouseOver" Value="True">
                                                                        <Setter Property= "Foreground" Value="Blue"/>
                                                                        <Setter Property="TextDecorations" Value="Underline"></Setter>
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>

                                            <ListBox.ItemContainerStyle>
                                                <Style TargetType="ListBoxItem">
                                                    <Setter Property="Margin"
                                                            Value="5 0 0 0"></Setter>
                                                    <Setter Property="BorderThickness"
                                                            Value="0"></Setter>
                                                    <Setter Property="Padding"
                                                            Value="0"></Setter>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                                                <Border x:Name="Bd"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        Background="{TemplateBinding Background}"
                                                                        Padding="{TemplateBinding Padding}"
                                                                        SnapsToDevicePixels="true">
                                                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <MultiTrigger>
                                                                        <MultiTrigger.Conditions>
                                                                            <Condition Property="IsMouseOver"
                                                                                       Value="True" />
                                                                        </MultiTrigger.Conditions>
                                                                        <Setter Property="Background"
                                                                                TargetName="Bd"
                                                                                Value="Transparent" />
                                                                        <Setter Property="BorderBrush"
                                                                                TargetName="Bd"
                                                                                Value="Transparent" />
                                                                    </MultiTrigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </ListBox.ItemContainerStyle>
                                        </ListBox>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2"
                                                Grid.RowSpan="2"
                                                HorizontalAlignment="Right"
                                                Margin="0,0,20,0"
                                                Orientation="Horizontal"
                                                VerticalAlignment="Center">

                                        <Label Content="{Binding TotalComments}" 
                                               Padding="0,3,0,0">
                                        </Label>

                                        <Label Visibility="{Binding TotalComments, Converter= {StaticResource IconCommentsVisibilityConverterKey}}">
                                            <iconPacks:PackIconCodicons Kind="Comment" />
                                        </Label>

                                        <StackPanel.InputBindings>
                                            <MouseBinding Command="{Binding ElementName=PART_ListIssues, Path=DataContext.NavigateCommand}" 
                                                          CommandParameter="{x:Static coreNameDef:CommandParameters.Comments}"
                                                          MouseAction="LeftClick" >
                                            </MouseBinding>
                                        </StackPanel.InputBindings>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
